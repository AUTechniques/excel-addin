<!-- 900*360 -->
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>QUERY</title>
  <link rel="stylesheet" type="text/css" href="function/code-inner.css">
  <link rel="stylesheet" type="text/css" href="function/macros.css">
</head>

<body>
  <h1>QUERY function
     <a href="interface.html"><button class="button button4" style="float: right;"><b>Download</b></button></a>
  </h1>

  <p>
  <div>● Truy vấn dữ liệu trên một bảng cố định dựa vào câu lệnh SQL.</div>
  </p>
  <p>
    <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
  </p>

  <blockquote>
    <p>&nbsp;VD1: tìm tất cả các chuỗi con bắt đầu với PERF (phần tô màu).</p>
  </blockquote>

  <img src="gif/query-like.gif">
  <p>
    <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
  </p>
 <blockquote>
    <p>&nbsp;VD2: Triển khai bảng thống kê ở dạng PIVOT (truy vấn không hỗ trợ keyword PIVOT).</p>
  </blockquote>
  <img src="gif/query.pivot.png">

  <p>
    <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
  </p>

  <p tabindex="-1" dir="auto">
    <note>
       <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16"
          aria-hidden="true">
          <path
             d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z">
          </path>
       </svg>
       <font style="vertical-align: inherit;">Support functions:</font>
    </note>
 </p>
 //<blockquote>
  <!-- <img src="gif/query.supportfunction.png">

  <p>&nbsp;1. DATETIME FUNCTIONS:</p>
  <p>&nbsp;- DATEADD/DATEPART/DATEDIFF/TIMESTAMP</p>
  <p>&nbsp;- HOUR/MINUTE/SECOND/DAY/MONTH/YEAR</p>
</blockquote>
<blockquote>
  <p>&nbsp;2. LOGIC FUNCTIONS:</p>
  <p>&nbsp;- ISINT/ISNUMBER/ISDATE</p>
  <p>&nbsp;- ISUPPER/ISLOWER/ISALPHA/ISDIGIT/ISALPHANUM/ISSYMBOL/ISLIKE/MATCHES</p>
  <p>&nbsp;- ISBLANK/ISZERO/ISNULL</p>
  <p>&nbsp;- GREATER/SMALLER/BETWEEN/EQUAL/ISODD/ISEVEN</p>
  <p>&nbsp;- STARTWITH/ENDWITH/CONTAIN</p>
</blockquote>
<blockquote>
  <p>&nbsp;3. CONVERT FUNCTIONS:</p>
  <p>&nbsp;- TO.INT/TO.NUM/TO.TEXT/TO.ENG </p>
  <p>&nbsp;- ROUNDUP/ROUNDDOWN/ROUNDNEAREST</p>
  <p>&nbsp;- UPPER/LOWER/PROPER/SENTENCE</p>
</blockquote>
<blockquote>
  <p>&nbsp;4. MATH FUNCTIONS:</p>
  <p>&nbsp;- AVERAGE/PLUS/MINUS/PRODUCT/DIVIDE/RAND/SUMIF/MAXIF/MINIF/AVERAGEIF/MEDIAN</p>
  <p>&nbsp;- SUM.A/MAX.A/MIN.A/AVERAGE.A</p>
  <p>&nbsp;- SQRT.A/CEILING.A/TRUNC.A/EXP.A/FLOOR.A/MOD.A/POW.A/POWER.A/SIGN.A/ABS.A/</p>
</blockquote>
<blockquote>
  <p>&nbsp;5. ARRAY FUNCTIONS:</p>
  <p>&nbsp;- INDEX/MATCH/FIRST/LAST/TAKE/DROP/HSTACK/SORT/SEQUENCE/NO()</p>
  <p>&nbsp;- FILTER/UNIQUE/NONBLANK/NONZERO/CHARS</p>
</blockquote>
<blockquote>
  <p>&nbsp;6. STRING FUNCTIONS:</p>
  <p>&nbsp;- FIND/FINDOF/FINDLAST/FINDLASTOF/FIND.AT</p>
  <p>&nbsp;- LEFT/MID/MID.W/MID.AT/RIGHT</p>
  <p>&nbsp;- CONCAT/JOIN/TEXTBEFORE/TEXTAFTER/SPLIT.PART/SPLIT </p>
  <p>&nbsp;- FORMAT/REPT/REVERSE/ERASE</p>
  <p>&nbsp;- TEXT.DIGIT/TEXT.INT/TEXT.NUM/TEXT.ALPHA/TEXT.ALPHANUM/TEXT.UPPER/TEXT.LOWER</p>
  <p>&nbsp;- REG.SPLIT/REG.EXTRACT/REG.REPLACE/REG.MATCH/REG.COUNT</p>
</blockquote>
<blockquote>
  <p>&nbsp;7. STATISTICAL FUNCTIONS:</p>
  <p>&nbsp;- COUNTA/COUNTBLANK/COUNT.A/COUNTZERO/COUNTNULL</p>
  <p>&nbsp;- COUNTIF/COUNT.W/COLUMNS</p> -->
//</blockquote>
<hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
<pre> FUNCTION NAME         | FUNCTION SYNTAX                                      |
-----------------------|------------------------------------------------------|
 DATETIME FUNCTIONS    | DATETIME FUNCTIONS                                   |
 DATEADD               | =DATE.ADD(interval, num, dates)                      |
 DATEPART              | =DATEPART(interval, dates)                           |
 DATEDIFF              | =DATEDIFF(interval, date1, date2)                    |
 TIMESTAMP             | =TIMESTAMP(datetimes)                                |
 HOUR                  | =HOUR(datetimes)                                     |
 MINUTE                | =MINUTE(datetimes)                                   |
 SECOND                | =SECOND(datetimes)                                   |
 DAY                   | =DAY(datetimes)                                      |
 MONTH                 | =MONTH(datetimes)                                    |
 YEAR                  | =YEAR(datetimes)                                     |
-----------------------|------------------------------------------------------|
 LOGIC FUNCTIONS       | LOGIC FUNCTIONS                                      |
 ISINT                 | =ISINT(values)                                       |
 ISNUMBER              | =ISNUMBER(values)                                    |
 ISDATE                | =ISDATE(values)                                      |
 ISUPPER               | =ISUPPER(values)                                     |
 ISLOWER               | =ISLOWER(values)                                     |
 ISALPHA               | =ISALPHA(values)                                     |
 ISDIGIT               | =ISDIGIT(values)                                     |
 ISALPHANUM            | =ISALPHANUM(values)                                  |
 ISSYMBOL              | =ISSYMBOL(values)                                    |
 ISLIKE                | =ISLIKE(values)                                      |
 MATCHES               | =OPERATOR                                             |
 ISBLANK               | =ISBLANK(values)                                     |
 ISZERO                | =ISZERO(values)                                      |
 ISNULL                | =ISNULL(values)                                      |
 GREATER               | =GREATER(values)                                     |
 SMALLER               | =SMALLER(values)                                     |
 BETWEEN               | =BETWEEN(values)                                     |
 EQUAL                 | =EQUAL(values)                                       |
 ISODD                 | =ISODD(values)                                       |
 ISEVEN                | =ISEVEN(values)                                      |
 STARTWITH             | =STARTWITH(values)                                   |
 ENDWITH               | =ENDWITH(values)                                     |
 CONTAIN               | =CONTAIN(values)                                     |
-----------------------|------------------------------------------------------|
 CONVERT FUNCTIONS     | CONVERT FUNCTIONS                                    |
 TO.INT                | =TO.INT(values)                                      |
 TO.NUM                | =TO.NUM(values)                                      |
 TO.TEXT               | =TO.TEXT(values)                                     |
 TO.ENG                | =TO.ENG(values)                                      |
 ROUNDUP               | =ROUNDUP(values)                                     |
 ROUNDDOWN             | =ROUNDDOWN(values, [num])                             |
 ROUNDNEAREST          | =ROUNDNEAREST(values, [num])                          |
 UPPER                 | =UPPER(values)                                       |
 LOWER                 | =LOWER(values)                                       |
 PROPER                | =PROPER(values)                                      |
 SENTENCE              | =SENTENCE(values)                                    |
-----------------------|------------------------------------------------------|
 MATH FUNCTIONS        | MATH FUNCTIONS                                       |
 AVERAGE               | =AVERAGE(column)                                     |
 PLUS                  | =PLUS(values,num)                                    |
 MINUS                 | =MINUS(values,num)                                   |
 PRODUCT               | =PRODUCT(values,num)                                 |
 DIVIDE                | =DIVIDE(values,num)                                  |
 RAND                  | =RAND()                                              |
 SUMIF                 | =SUMIF(values, criteria)                             |
 MAXIF                 | =MAXIF(values, criteria)                             |
 MINIF                 | =MINIF(values, criteria)                             |
 AVERAGEIF             | =AVERAGEIF(values, criteria)                         |
 MEDIAN                | =MEDIAN(values)                                      |
 SUM.A                 | =SUM.A(values)                                       |
 MAX.A                 | =MAX.A(values)                                       |
 MIN.A                 | =MIN.A(values)                                       |
 AVERAGE.A             | =AVERAGE.A(values)                                   |
 SQRT.A                | =SQRT.A(values)                                      |
 CEILING.A             | =CEILING.A(values)                                   |
 TRUNC.A               | =TRUNC.A(values)                                     |
 EXP.A                 | =EXP.A(values)                                       |
 FLOOR.A               | =FLOOR.A(values)                                     |
 MOD.A                 | =MOD.A(values,num)                                   |
 POW.A                 | =POW.A(values,num)                                   |
 POWER.A               | =POWER.A(values,num)                                 |
 SIGN.A                | =SIGN.A(values)                                      |
 ABS.A                 | =ABS.A(values)                                       |
-----------------------|------------------------------------------------------|
 ARRAY FUNCTIONS       | ARRAY FUNCTIONS                                      |
 INDEX                 | =INDEX(values, num)                                |
 MATCH                 | =MATCH(lookup_value,values)                          |
 FIRST                 | =FIRST(values)                                       |
 LAST                  | =LAST(values)                                        |
 TAKE                  | =TAKE(values, num)                                    |
 DROP                  | =TAKE(values, num)                                    |
 HSTACK                | =HSTACK(values)                                      |
 SORT                  | =SORT(values, order)                                 |
 SEQUENCE              | =SEQUENCE(num1, num2)                                 |
 NO()                  | =NO()                                                |
 FILTER                | =FILTER(values, criteria)                            |
 UNIQUE                | =UNIQUE(values)                                      |
 NONBLANK              | =NONBLANK(values)                                    |
 NONZERO               | =NONZERO(values)                                     |
 CHARS                 | =CHARS(values)                                       |
-----------------------|------------------------------------------------------|
 STRING FUNCTIONS      | STRING FUNCTIONS                                     |
 FIND                  | =FIND(with_text, find_text)                          |
 FINDOF                | =FINDOF(with_text, find_text)                        |
 FINDLAST              | =FINDLAST(with_text, find_text)                      |
 FINDLASTOF            | =FINDLASTOF(with_text, find_text)                    |
 FIND.AT               | =FIND.AT(with_text, find_text, num)                  |
 LEFT                  | =LEFT(values, num)                                   |
 MID                   | =MID(values, num)                                    |
 MID.W                 | =MID.W(values, text1, text2)                         |
 MID.AT                | =MID.AT(values, text1, text2, num)                   |
 RIGHT                 | =RIGHT(values, num)                                  |
 CONCAT                | =CONCAT(values)                                      |
 JOIN                  | =JOIN(delimiter, ignore_empty, values)               |
 TEXTBEFORE            | =TEXTBEFORE(values, delimiter, [instance_num])       |
 TEXTAFTER             | =TEXTAFTER(values, delimiter, [instance_num])        |
 SPLIT.PART            | =SPLIT.PART(values, delimiter, [instance_num])       |
 SPLIT                 | =SPLIT(values, delimiter, [ignore_empty])            |
                       | =SPLIT(values, delimiter, [by_each], [ignore_empty]) |
 FORMAT                | =FORMAT(values, format_code)                         |
 REPT                  | =REPT(values, num)                                   |
 REVERSE               | =REVERSE(value[s])                                   |
 ERASE                 | =ERASE(values, [char_type], [include_space])         |
 TEXT.DIGIT            | =TEXT.DIGIT(values, [include_space])                 |
 TEXT.INT              | =TEXT.INT(values, [num])                             |
 TEXT.NUM              | =TEXT.NUM(values, [num])                             |
 TEXT.ALPHA            | =TEXT.ALPHA(values, [include_space])                 |
 TEXT.ALPHANUM         | =TEXT.ALPHANUM(values, [include_space])              |
 TEXT.UPPER            | =TEXT.UPPER(values, [include_space])                 |
 TEXT.LOWER            | =TEXT.LOWER(values, [include_space])                 |
 REG.SPLIT             | =REG.SPLIT(values, pattern, [num])                   |
 REG.EXTRACT           | =REG.EXTRACT(values, pattern, [num])                 |
 REG.REPLACE           | =REG.REPLACE(values, pattern, replace_text)          |
 REG.MATCH             | =REG.MATCH(values, pattern)                          |
 REG.COUNT             | =REG.COUNT(values, pattern, [is_group])              |
-----------------------|------------------------------------------------------|
 STATISTICAL FUNCTIONS | STATISTICAL FUNCTIONS                                |
 COUNTA                | =COUNTA(values)                                      |
 COUNTBLANK            | =COUNTBLANK(values)                                  |
 COUNT.A               | =COUNT.A(values)                                     |
 COUNTZERO             | =COUNTZERO(values)                                   |
 COUNTNULL             | =COUNTNULL(values)                                   |
 COUNTIF               | =COUNTIF(values)                                     |
 COUNT.W               | =COUNT.W(values)                                     |
 COLUMNS               | =COLUMNS(values)                                     |
</pre>


  <p><strong>Related function</strong></p>

  <p>
    <a href="xquery.html">XQUERY</a>&nbsp;&nbsp;&nbsp;Truy vấn dữ liệu giữa nhiều bảng dựa vào câu lệnh SQL.
  </p>
  <p>
    <a href="pivot.html">PIVOT</a>&nbsp;&nbsp;&nbsp;Tương tự chức năng PIVOT trong Power Query.
  </p>
  <p>Return to <a href="index.function.html">Home</a></p>

</body>

</html>