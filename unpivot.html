<!-- 850*360 -->
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>UNPIVOT</title>
  <link rel="stylesheet" type="text/css" href="function/code-inner.css">
  <link rel="stylesheet" type="text/css" href="function/macros.css">
</head>

<body>
  <h1>UNPIVOT function
    <a href="interface.html"><button class="button button4" style="float: right;"><b>Download</b></button></a>
  </h1>

  <p>
  <div>● Thuộc bộ hàm thao tác mảng, đây là hàm đối nghịch của PIVOT. </div>
  </p>
  <p>
    <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
  </p>
  <blockquote>
    <p>&nbsp;VD1: chuyển đổi kiểu dữ liệu với hàm UNPIVOT 2 cấp độ trước khi tổng hợp bằng hàm GROUP.</p>
  </blockquote>
  <img src="gif/unpivot.gif">

  <blockquote>
    <p>&nbsp;VD2: sử dụng truy vấn SQL với từ khóa UNPIVOT.</p>
  </blockquote>
  <img src="gif/unpivot.sql.png">

  <p tabindex="-1" dir="auto">
    <note>
      <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
        <path
          d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z">
        </path>
      </svg>
      <font style="vertical-align: inherit;">Lưu ý:</font>
    </note>
  </p>
  <blockquote>
    <p>&nbsp;Đối với các bảng cấp độ lớn hơn 2, tạo hàng mới và thu gom tiêu đề về 2 cấp độ.</p>
  </blockquote>

  <img src="gif/unpivot.level4.png">
  <p>
    <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
  </p>

  <img src="gif/unpivot.lv4header.png">

  <blockquote>
    <p>&nbsp;Sử dụng các hàm thao tác mảng: HSTACK, CHOOSECOLS, SPLITX để tạo dữ liệu như yêu cầu.</p>
  </blockquote>

  <img src="gif/unpivot.lv4result.png">

  <code class="language-xls" style="word-spacing: -3px;"><span class="token operator">=</span><a class="token function" href="">LET</a><span class="token punctuation">(</span><span class="token define name">DATA</span><span class="token punctuation">,</span><a class="token function" href="">DROP</a><span class="token punctuation">(</span><a class="token function" href="/unpivot">UNPIVOT.\AU</a><span class="token punctuation">(</span><span class="token range selector">A4:Z58</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"group"</span><span class="token punctuation">,</span><span class="token string">"title"</span><span class="token punctuation">,</span><span class="token string">"value"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><a class="token function" href="">HSTACK</a><span class="token punctuation">(</span><a class="token function" href="">CHOOSECOLS</a><span class="token punctuation">(</span><span class="token define name">DATA</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><a class="token function" href="/splitx">SPLITX.\AU</a><span class="token punctuation">(</span><a class="token function" href="">CHOOSECOLS</a><span class="token punctuation">(</span><span class="token define name">DATA</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><a class="token function" href="">CHOOSECOLS</a><span class="token punctuation">(</span><span class="token define name">DATA</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code>

  <code class="language-xls"
    style="word-spacing: -3px;"><span class="token operator">=</span><a class="token function" href="/sql.html">SQL.AU</a><span class="token punctuation">(</span><span class="token range selector">A1:D4</span><span class="token punctuation">,</span><span class="token string">"SELECT * FROM TABLE AS P UNPIVOT (VALUE FOR NAME IN ([ADAM],[ALICE])) AS T"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span></code>
  <p><strong>Related function</strong></p>

  <p>
    <a href="pivot.html">PIVOT</a>&nbsp;&nbsp;&nbsp;Một triển khai tương tự với chức năng PIVOTTABLE.
  </p>
  <p>
    <a href="group.html">GROUP</a>
    &nbsp;&nbsp;&nbsp;Phân nhóm bảng dữ liệu dựa trên trường (cột) chỉ định, hỗ trợ tính toán tùy chỉnh.
  </p>

  <p>Return to <a href="index.function.html">Home</a></p>

</body>

</html>